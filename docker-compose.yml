services:
  smartreply-clone:
    build: .
    container_name: smartreply-clone
    restart: unless-stopped
    ports:
      - "8000:8009"
    environment:
      META_APP_SECRET: ${META_APP_SECRET}
      META_APP_ID: ${META_APP_ID}
      META_API_TOKEN: ${META_API_TOKEN}
      PAGE_ACCESS_TOKEN: ${PAGE_ACCESS_TOKEN}

      # LLM Configuration
      # Choose one provider and set the corresponding API key
      # OPENAI_API_KEY=your_openai_api_key_here
      GOOGLE_API_KEY: ${GOOGLE_API_KEY}

      # LLM Provider Settings
      # Options: "openai" or "google"
      LLM_PROVIDER: ${LLM_PROVIDER:-google}
      # OpenAI models: "gpt-3.5-turbo", "gpt-4", "gpt-4-turbo"
      # Google models: "gemini-pro", "gemini-pro-vision"
      LLM_MODEL: ${LLM_MODEL:-gemini-2.5-flash}

      # Database Configuration
      # SQLite database file path
      DATABASE_URL: ${DATABASE_URL:-sqlite:///./comments.db}

      # Optional: Logging Level
      # Options: DEBUG, INFO, WARNING, ERROR
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
      AUTO_DELETE_NEGATIVE_INTENT: ${AUTO_DELETE_NEGATIVE_INTENT:-false}
      # TESTING=true
      GOOGLE_SERVICE_ACCOUNT_JSON: ${GOOGLE_SERVICE_ACCOUNT_JSON}
      GOOGLE_SHEETS_SPREADSHEET_ID: ${GOOGLE_SHEETS_SPREADSHEET_ID}
      GOOGLE_SHEETS_NEGATIVE_SHEET_NAME: ${GOOGLE_SHEETS_NEGATIVE_SHEET_NAME:-Negative Comments}
      
    volumes:
      - ./logs:/app/logs
      - ./comments.db:/app/comments.db
    networks:
      - smartreply-network

    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8009/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

networks:
  smartreply-network:
    driver: bridge
